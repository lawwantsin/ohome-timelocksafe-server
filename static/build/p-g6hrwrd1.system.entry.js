var __awaiter=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(s,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function o(e){try{u(n["throw"](e))}catch(e){i(e)}}function u(e){e.done?s(e.value):new r(function(t){t(e.value)}).then(a,o)}u((n=n.apply(e,t||[])).next())})};var __generator=this&&this.__generator||function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(e){return function(t){return u([e,t])}}function u(a){if(n)throw new TypeError("Generator is already executing.");while(r)try{if(n=1,s&&(i=a[0]&2?s["return"]:a[0]?s["throw"]||((i=s["return"])&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;if(s=0,i)a=[a[0]&2,i.value];switch(a[0]){case 0:case 1:i=a;break;case 4:r.label++;return{value:a[1],done:false};case 5:r.label++;s=a[1];a=[0];continue;case 7:a=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1];i=a;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(a);break}if(i[2])r.ops.pop();r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e];s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};System.register(["./p-e28de766.system.js","./p-5a8f6e15.system.js","./p-0ea21cb9.system.js"],function(e){"use strict";var t,r,n,s,i;return{setters:[function(e){t=e.r;r=e.h},function(e){n=e.U;s=e.W},function(e){i=e.m}],execute:function(){var a="LL LTS";var o=function(e,t){return e.id>t.id?1:-1};var u=function(){function e(e){var r=this;t(this,e);this.alarms=[];this.serverMsg="";this.componentDidLoad=function(){return __awaiter(r,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.getTime()];case 1:e.sent();return[4,this.getAlarms()];case 2:e.sent();return[2]}})})};this.getTime=function(){return __awaiter(r,void 0,void 0,function(){var e,t,r,s,a;var o=this;return __generator(this,function(u){switch(u.label){case 0:u.trys.push([0,3,,4]);return[4,n.get("time.json")];case 1:e=u.sent();console.log(e);return[4,e.json()];case 2:t=u.sent();r=t.data.local.split(" ");r.pop();s=r.join("T");if(e.ok){if(s){console.log(s);this.currentTime=i(s).toDate();console.log(i(s,"YYYY-MM-DDTHH:MM:SS"));setInterval(function(){return o.setNow},1e3)}}else{this.serverMsg=t.message}return[3,4];case 3:a=u.sent();console.error(a);this.serverMsg=a;return[3,4];case 4:return[2]}})})};this.setNow=function(){var e=r.currentTime;e.setSeconds(e.getSeconds()+1);r.currentTime=e;console.log(r.currentTime)};this.getAlarms=function(){return __awaiter(r,void 0,void 0,function(){var e,t;return __generator(this,function(r){switch(r.label){case 0:return[4,n.get("alarms.json")];case 1:e=r.sent();return[4,e.json()];case 2:t=r.sent();if(e.ok){this.alarms=n.parseAlarms(t.data).sort(o)}else{this.serverMsg=t.message}return[2]}})})};this.removeAlarm=function(e){return __awaiter(r,void 0,void 0,function(){var t,r;return __generator(this,function(s){switch(s.label){case 0:return[4,n.get("delete.json",{delaid:e})];case 1:t=s.sent();return[4,t.json()];case 2:r=s.sent();if(t.ok){this.alarms=this.alarms.filter(function(t){return t.id!==e}).sort(o)}else{this.serverMsg=r.message}return[2]}})})};this.toggle=function(e){return __awaiter(r,void 0,void 0,function(){var t,r,s;return __generator(this,function(i){switch(i.label){case 0:return[4,n.get("toggle.json",{toggleaid:e.id})];case 1:t=i.sent();return[4,t.json()];case 2:r=i.sent();if(t.ok){s=this.alarms.filter(function(t){return e.id!==t.id});e.enabled=!e.enabled;this.alarms=s.concat([e]).sort(o)}else{this.serverMsg=r.message}return[2]}})})};this.openNow=function(){return __awaiter(r,void 0,void 0,function(){var e,t;return __generator(this,function(r){switch(r.label){case 0:return[4,n.get("unlock.json")];case 1:e=r.sent();return[4,e.json()];case 2:t=r.sent();if(e.ok);else{this.serverMsg=t.message}return[2]}})})}}e.prototype.render=function(){var e=this;var t=this.alarms.sort(function(e,t){return t.id-e.id}).map(function(t){var n=t.hour<12?"AM":"PM";var i=n==="PM"?t.hour-12:t.hour;if(i==0)i=12;var a=t.min<10?"0"+t.min:t.min;var o=t.days?s.map(function(e,n){var s=t.days[""+n]?"active":"";var i="day "+s;return r("div",{class:i},e)}):"";var u=t.freq!==1?"days":"day";var c=r("div",{class:"weekdays"},o);var l=r("div",{class:"frequency"},"Every ",t.freq," ",u);var f=t.freq?l:c;return r("li",{class:"item"},r("div",{class:"switch"},r("toggle-switch",{enabled:t.enabled,vertical:true,toggleClick:function(){return e.toggle(t)}})),r("div",{class:"time"},r("span",{class:"hour"},i),r("span",{class:"colon"},":"),r("span",{class:"minute"},a),r("span",{class:"meridian"},n)),r("div",{class:"days"},f),r("div",{class:"buttons"},r("icon-button",{face:"remove",buttonClick:function(){return e.removeAlarm(t.id)}})))});return r("div",{class:"list"},r("server-notice",{message:this.serverMsg}),r("h2",null,"Box Time: ",i(this.currentTime).format(a)),r("stencil-route-link",{url:"/add"},r("post-button",null,"Add Alarm")),t.length>0?r("div",null,r("h2",null,"The Box will UNLOCK at these times."),r("ul",{class:"items"},t)):r("div",{class:"noItems"},"No Alarms Set"),r("post-button",{onClick:function(){return e.openNow()}},"Open Box Now"))};Object.defineProperty(e,"style",{get:function(){return".list{width:640px;margin:0 auto}.item{display:grid;grid-template-columns:35px 190px 1fr 40px;grid-gap:16px;padding:24px 12px;margin:8px 0}.item,.noItems{background-color:#eee;border-radius:6px;-webkit-box-shadow:inset 0 0 15px #444,1px 3px 6px rgba(0,0,0,.6);box-shadow:inset 0 0 15px #444,1px 3px 6px rgba(0,0,0,.6)}.noItems{margin:16px 0;padding:40px 0;text-align:center;font-size:2em}.switch{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.enable p{margin:0}h1{font-size:35px;margin-bottom:0}h1,h2{color:#fff;font-weight:100;text-align:center}h2{font-size:18px;margin:20px 0 10px 0}ul{list-style:none;padding:0}a{text-decoration:none}.time{display:-ms-flexbox;display:flex;-ms-flex-align:end;align-items:flex-end;-ms-flex-pack:end;justify-content:flex-end;font-size:45px;line-height:55px}.meridian{color:#666;padding:0 5px;margin:0 5px;font-size:30px;text-transform:uppercase}.weekdays{display:block;font-size:.8em}.day{border-radius:3px;display:inline-block;padding:6px 7px;margin:0 5px 3px 0}.weekdays{color:#999}.frequency{font-size:45px;line-height:55px}.active{border-color:#444;background-color:#666;color:#fff}.buttons{display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around}\@media (max-width:768px){.list{margin:0 4px}.time{-ms-flex-pack:start;justify-content:flex-start;-ms-flex-align:center;align-items:center;font-size:1.8em}.frequency{font-size:20px;line-height:20px}.meridian{font-size:inherit}.switch{-ms-flex-align:center;align-items:center;grid-row:1/3}.item{position:relative;display:grid;grid-template-columns:50px 120px 1fr;grid-gap:8px;padding:0 12px}.weekdays{width:198px;height:68px;padding:14px 0 0 0}.day{display:inline-block;padding:4px 8px;margin:0 2px 2px 0;border-radius:3px}.buttons{position:absolute;right:13px;top:12px;display:grid;grid-template-columns:1fr;grid-gap:4px}}"},enumerable:true,configurable:true});return e}();e("list_page",u)}}});