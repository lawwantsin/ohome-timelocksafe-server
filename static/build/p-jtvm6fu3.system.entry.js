var __awaiter=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(s,r){function o(t){try{u(i.next(t))}catch(t){r(t)}}function a(t){try{u(i["throw"](t))}catch(t){r(t)}}function u(t){t.done?s(t.value):new n(function(e){e(t.value)}).then(o,a)}u((i=i.apply(t,e||[])).next())})};var __generator=this&&this.__generator||function(t,e){var n={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},i,s,r,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(e){return u([t,e])}}function u(o){if(i)throw new TypeError("Generator is already executing.");while(n)try{if(i=1,s&&(r=o[0]&2?s["return"]:o[0]?s["throw"]||((r=s["return"])&&r.call(s),0):s.next)&&!(r=r.call(s,o[1])).done)return r;if(s=0,r)o=[o[0]&2,r.value];switch(o[0]){case 0:case 1:r=o;break;case 4:n.label++;return{value:o[1],done:false};case 5:n.label++;s=o[1];o=[0];continue;case 7:o=n.ops.pop();n.trys.pop();continue;default:if(!(r=n.trys,r=r.length>0&&r[r.length-1])&&(o[0]===6||o[0]===2)){n=0;continue}if(o[0]===3&&(!r||o[1]>r[0]&&o[1]<r[3])){n.label=o[1];break}if(o[0]===6&&n.label<r[1]){n.label=r[1];r=o;break}if(r&&n.label<r[2]){n.label=r[2];n.ops.push(o);break}if(r[2])n.ops.pop();n.trys.pop();continue}o=e.call(t,n)}catch(t){o=[6,t];s=0}finally{i=r=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}};System.register(["./p-e28de766.system.js","./p-5a8f6e15.system.js","./p-0ea21cb9.system.js"],function(t){"use strict";var e,n,i,s,r,o,a;return{setters:[function(t){e=t.r;n=t.h},function(t){i=t.P;s=t.D;r=t.U;o=t.F},function(t){a=t.m}],execute:function(){var u=function(){function t(t){var n=this;e(this,t);this.hour=4;this.min=20;this.freq=1;this.base=12;this.meridian=i;this.days={};this.mode=s;this.dfn=0;this.hfn=0;this.serverMsg="";this.componentDidLoad=function(){return __awaiter(n,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:t=this.match.params.id;if(!t)return[3,2];return[4,r.get("alarms",{id:t})];case 1:e=n.sent();this.hour=e.hour;this.min=e.min;this.freq=e.frequency;n.label=2;case 2:return[2]}})})};this.setDFN=function(t){n.dfn=t};this.setHFN=function(t){n.hfn=t;console.log(n.hfn,t)};this.setMode=function(t){n.mode=t};this.setTime=function(t){var e=r.setTime(t,n.base),i=e.hour,s=e.min;console.log(i,s);n.hour=i;n.min=s};this.setDay=function(t){var e;var i=(e={},e[t]=!n.days[t],e);n.days=Object.assign({},n.days,i)};this.setAll=function(t){var e={0:true,1:true,2:true,3:true,4:true,5:true,6:true};n.days=t?e:{}};this.setMeridian=function(t){n.meridian=t};this.setFreq=function(t){n.freq=t};this.submitPayload=function(){return __awaiter(n,void 0,void 0,function(){var t,e,n,s,o,a,u,h,c,l;return __generator(this,function(f){switch(f.label){case 0:t=function(t){return encodeURIComponent(String(t))};e=this,n=e.min,s=e.days,o=e.meridian;a=o==i?this.hour+12:this.hour;u={h:t(a),m:t(n),mb:1,mf:1};h=["m","t","w","h","f","s","u"];h.map(function(t,e){if(s[e])u["dow"+t]=""+e});return[4,r.get("edit.json",u)];case 1:c=f.sent();return[4,c.json()];case 2:l=f.sent();if(c.ok){this.history.replace("/list")}else{this.serverMsg=l.message}return[2]}})})}}t.prototype.render=function(){var t=this;var e=this.mode===o;var i=a().add(this.dfn,"d").add(this.hfn,"h").format("dddd, MMMM Do YYYY, h:mm A");var s=n("h2",null,"Will open ",i);return n("div",{class:"edit"},n("nav-header",null),n("server-notice",{message:this.serverMsg}),n("h1",null,"Set Alarm"),n("h2",null,"I want to UNLOCK the box"),n("mode-selector",{onMode:this.setMode,selectedValue:this.mode}),e?s:"",n("div",{class:"hidden"},n("form-wizard",null,n("day-setter",{setFreq:this.setFreq,setDay:this.setDay,setAll:this.setAll,setDFN:this.setDFN,freq:this.freq,days:this.days,slot:"page1",dfn:this.dfn,mode:this.mode}),n("time-setter",{hour:this.hour,min:this.min,hfn:this.hfn,base:this.base,meridian:this.meridian,setMeridian:this.setMeridian,setTime:this.setTime,setHFN:this.setHFN,slot:"page2",mode:this.mode}))),n("post-button",{onClick:function(){return t.submitPayload()}},"Save"))};Object.defineProperty(t,"style",{get:function(){return".edit{max-width:920px;margin:0 auto}h1{font-size:35px;margin-bottom:0}h1,h2{color:#fff;font-weight:100;text-align:center}h2{font-size:18px;margin:20px 0 10px 0}"},enumerable:true,configurable:true});return t}();t("edit_page",u)}}});