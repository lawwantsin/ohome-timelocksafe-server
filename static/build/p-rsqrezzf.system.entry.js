var __awaiter=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(r,s){function a(t){try{u(i.next(t))}catch(t){s(t)}}function o(t){try{u(i["throw"](t))}catch(t){s(t)}}function u(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(a,o)}u((i=i.apply(t,e||[])).next())})};var __generator=this&&this.__generator||function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,r,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(t){return function(e){return u([t,e])}}function u(a){if(i)throw new TypeError("Generator is already executing.");while(n)try{if(i=1,r&&(s=a[0]&2?r["return"]:a[0]?r["throw"]||((s=r["return"])&&s.call(r),0):r.next)&&!(s=s.call(r,a[1])).done)return s;if(r=0,s)a=[a[0]&2,s.value];switch(a[0]){case 0:case 1:s=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;r=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(s=n.trys,s=s.length>0&&s[s.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!s||a[1]>s[0]&&a[1]<s[3])){n.label=a[1];break}if(a[0]===6&&n.label<s[1]){n.label=s[1];s=a;break}if(s&&n.label<s[2]){n.label=s[2];n.ops.push(a);break}if(s[2])n.ops.pop();n.trys.pop();continue}a=e.call(t,n)}catch(t){a=[6,t];r=0}finally{i=s=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};System.register(["./p-e28de766.system.js","./p-5a8f6e15.system.js","./p-0ea21cb9.system.js"],function(t){"use strict";var e,n,i,r,s,a,o;return{setters:[function(t){e=t.r;n=t.h},function(t){i=t.P;r=t.D;s=t.U;a=t.F},function(t){o=t.m}],execute:function(){var u=function(){function t(t){var n=this;e(this,t);this.hour=4;this.min=20;this.freq=1;this.base=12;this.meridian=i;this.days={};this.mode=r;this.dfn=0;this.hfn=0;this.serverMsg="";this.componentDidLoad=function(){return __awaiter(n,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:t=this.match.params.id;if(!t)return[3,2];return[4,s.get("alarms",{id:t})];case 1:e=n.sent();this.hour=e.hour;this.min=e.min;this.freq=e.frequency;n.label=2;case 2:return[2]}})})};this.setDFN=function(t){n.dfn=t};this.setHFN=function(t){n.hfn=t;console.log(n.hfn,t)};this.setMode=function(t){n.mode=t};this.setTime=function(t){var e=s.setTime(t,n.base),i=e.hour,r=e.min;console.log(i,r);n.hour=i;n.min=r};this.setDay=function(t){var e;var i=(e={},e[t]=!n.days[t],e);n.days=Object.assign({},n.days,i)};this.setAll=function(t){var e={0:true,1:true,2:true,3:true,4:true,5:true,6:true};n.days=t?e:{}};this.setMeridian=function(t){n.meridian=t};this.setFreq=function(t){n.freq=t};this.submitPayload=function(){return __awaiter(n,void 0,void 0,function(){var t,e,n,r,a,o,u,h,c,f;return __generator(this,function(l){switch(l.label){case 0:t=function(t){return encodeURIComponent(String(t))};e=this,n=e.min,r=e.days,a=e.meridian;o=a==i?this.hour+12:this.hour;u={h:t(o),m:t(n),mb:1,mf:1};h=["m","t","w","h","f","s","u"];h.map(function(t,e){if(r[e])u["dow"+t]=""+e});return[4,s.get("edit.json",u)];case 1:c=l.sent();return[4,c.json()];case 2:f=l.sent();if(c.ok){this.history.replace("/alarms")}else{this.serverMsg=f.message}return[2]}})})}}t.prototype.render=function(){var t=this;var e=this.mode===a;var i=o().add(this.dfn,"d").add(this.hfn,"h").format("dddd, MMMM Do YYYY, h:mm A");var r=n("h2",null,"Will open ",i);return n("div",{class:"edit"},n("server-notice",{message:this.serverMsg}),n("h1",null,"Set Alarm"),n("h2",null,"I want to UNLOCK the box"),e?r:"",n("div",{class:"hidden"},n("form-wizard",null,n("day-setter",{setFreq:this.setFreq,setDay:this.setDay,setAll:this.setAll,setDFN:this.setDFN,freq:this.freq,days:this.days,slot:"page1",dfn:this.dfn,mode:this.mode}),n("time-setter",{hour:this.hour,min:this.min,hfn:this.hfn,base:this.base,meridian:this.meridian,setMeridian:this.setMeridian,setTime:this.setTime,setHFN:this.setHFN,slot:"page2",mode:this.mode}))),n("post-button",{onClick:function(){return t.submitPayload()}},"Save"))};Object.defineProperty(t,"style",{get:function(){return".edit{width:920px;margin:0 auto}h1{font-size:35px;margin-bottom:0}h1,h2{color:#fff;font-weight:100;text-align:center}h2{font-size:18px;margin:20px 0 10px 0}"},enumerable:true,configurable:true});return t}();t("edit_page",u)}}});