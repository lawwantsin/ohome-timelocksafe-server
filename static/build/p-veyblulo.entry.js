import{r as s,h as t}from"./p-3278c467.js";import{U as e,W as a}from"./p-51b2ba9a.js";import{m as i}from"./p-349cadab.js";const o="LL LTS",r=(s,t)=>s.id>t.id?1:-1;class l{constructor(t){s(this,t),this.alarms=[],this.serverMsg="",this.componentDidLoad=async()=>{await this.getTime(),await this.getAlarms()},this.getTime=async()=>{try{const s=await e.get("time.json"),t=await s.json();let a=t.data.local.split(" ");a.pop();const o=a.join("T");s.ok?o&&(this.currentTime=i(o).toDate(),i(o,"YYYY-MM-DDTHH:MM:SS"),setInterval(()=>this.setNow,1e3)):this.serverMsg=t.message}catch(s){console.error(s),this.serverMsg=s}},this.setNow=()=>{const s=this.currentTime;s.setSeconds(s.getSeconds()+1),this.currentTime=s},this.getAlarms=async()=>{const s=await e.get("alarms.json"),t=await s.json();s.ok?this.alarms=e.parseAlarms(t.data).sort(r):this.serverMsg=t.message},this.removeAlarm=async s=>{const t=await e.get("delete.json",{delaid:s}),a=await t.json();t.ok?this.alarms=this.alarms.filter(t=>t.id!==s).sort(r):this.serverMsg=a.message},this.toggle=async s=>{const t=await e.get("toggle.json",{toggleaid:s.id}),a=await t.json();if(t.ok){const t=this.alarms.filter(t=>s.id!==t.id);s.enabled=!s.enabled,this.alarms=[...t,s].sort(r)}else this.serverMsg=a.message},this.openNow=async()=>{const s=await e.get("unlock.json"),t=await s.json();s.ok||(this.serverMsg=t.message)}}render(){const s=this.alarms.sort((s,t)=>t.id-s.id).map(s=>{const e=s.hour<12?"AM":"PM";let i="PM"===e?s.hour-12:s.hour;0==i&&(i=12);const o=s.min<10?`0${s.min}`:s.min,r=s.days?a.map((e,a)=>t("div",{class:`day ${s.days[`${a}`]?"active":""}`},e)):"",l=1!==s.freq?"days":"day",n=t("div",{class:"weekdays"},r),c=t("div",{class:"frequency"},"Every ",s.freq," ",l),m=s.freq?c:n;return t("li",{class:"item"},t("div",{class:"switch"},t("toggle-switch",{enabled:s.enabled,vertical:!0,toggleClick:()=>this.toggle(s)})),t("div",{class:"time"},t("span",{class:"hour"},i),t("span",{class:"colon"},":"),t("span",{class:"minute"},o),t("span",{class:"meridian"},e)),t("div",{class:"days"},m),t("div",{class:"buttons"},t("icon-button",{face:"remove",buttonClick:()=>this.removeAlarm(s.id)})))});return t("div",{class:"list"},t("server-notice",{message:this.serverMsg}),t("h2",null,"Box Time: ",i(this.currentTime).format(o)),t("stencil-route-link",{url:"/add"},t("post-button",null,"Add Alarm")),s.length>0?t("div",null,t("h2",null,"The Box will UNLOCK at these times."),t("ul",{class:"items"},s)):t("div",{class:"noItems"},"No Alarms Set"),t("post-button",{onClick:()=>this.openNow()},"Open Box Now"))}static get style(){return".list{width:640px;margin:0 auto}.item{display:grid;grid-template-columns:35px 190px 1fr 40px;grid-gap:16px;padding:24px 12px;margin:8px 0}.item,.noItems{background-color:#eee;border-radius:6px;-webkit-box-shadow:inset 0 0 15px #444,1px 3px 6px rgba(0,0,0,.6);box-shadow:inset 0 0 15px #444,1px 3px 6px rgba(0,0,0,.6)}.noItems{margin:16px 0;padding:40px 0;text-align:center;font-size:2em}.switch{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.enable p{margin:0}h1{font-size:35px;margin-bottom:0}h1,h2{color:#fff;font-weight:100;text-align:center}h2{font-size:18px;margin:20px 0 10px 0}ul{list-style:none;padding:0}a{text-decoration:none}.time{display:-ms-flexbox;display:flex;-ms-flex-align:end;align-items:flex-end;-ms-flex-pack:end;justify-content:flex-end;font-size:45px;line-height:55px}.meridian{color:#666;padding:0 5px;margin:0 5px;font-size:30px;text-transform:uppercase}.weekdays{display:block;font-size:.8em}.day{border-radius:3px;display:inline-block;padding:6px 7px;margin:0 5px 3px 0}.weekdays{color:#999}.frequency{font-size:45px;line-height:55px}.active{border-color:#444;background-color:#666;color:#fff}.buttons{display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around}\@media (max-width:768px){.list{margin:0 4px}.time{-ms-flex-pack:start;justify-content:flex-start;-ms-flex-align:center;align-items:center;font-size:1.8em}.frequency{font-size:20px;line-height:20px}.meridian{font-size:inherit}.switch{-ms-flex-align:center;align-items:center;grid-row:1/3}.item{position:relative;display:grid;grid-template-columns:50px 120px 1fr;grid-gap:8px;padding:0 12px}.weekdays{width:198px;height:68px;padding:14px 0 0 0}.day{display:inline-block;padding:4px 8px;margin:0 2px 2px 0;border-radius:3px}.buttons{position:absolute;right:13px;top:12px;display:grid;grid-template-columns:1fr;grid-gap:4px}}"}}export{l as list_page};